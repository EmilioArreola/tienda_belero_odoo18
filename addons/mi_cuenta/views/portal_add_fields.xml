<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <template id="mi_cuenta_fields_new" name="Mis Campos Personalizados">
            
            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
            
            <div t-if="error_message" class="alert alert-danger" role="alert">
                <t t-foreach="error_message" t-as="err"><t t-esc="err"/><br/></t>
            </div>

            <div class="row">
                <div class="col-xl-6 mb-3">
                    <label class="col-form-label">Nombre</label>
                    <input type="text" name="name" class="form-control" t-att-value="name or partner.name"/>
                </div>
                <div class="col-xl-6 mb-3">
                    <label class="col-form-label">Email</label>
                    <input type="email" name="email" class="form-control" t-att-value="email or partner.email"/>
                </div>
            </div>

            <div class="clearfix"/>

            <div class="row mt-3 pt-3 border-top" style="background-color: #f9f9f9; padding: 15px; border-radius: 5px;">
                <div class="col-12 mb-3">
                    <h5 style="color: #d9534f; font-weight: bold;">
                        <i class="fa fa-id-card-o"/> Datos de Facturación (MX)
                    </h5>
                </div>

                <div class="col-xl-6 mb-3">
                    <label class="col-form-label font-weight-bold">RFC</label>
                    <input type="text" name="vat" class="form-control"
                           t-att-value="partner.vat or ''" placeholder="XAXX010101000"/>
                </div>

                <div class="col-xl-6 mb-3">
                    <label class="col-form-label font-weight-bold">Régimen Fiscal</label>
                    <input type="text" name="x_regimen_fiscal" class="form-control"
                           t-att-value="partner.x_regimen_fiscal or ''" placeholder="Ej. 601"/>
                </div>

                <div class="col-xl-6 mb-3">
                    <label class="col-form-label font-weight-bold">Uso de CFDi</label>
                    <input type="text" name="x_uso_cfdi" class="form-control"
                           t-att-value="partner.x_uso_cfdi or ''" placeholder="Ej. G03"/>
                </div>
            </div>
            
            <div class="row mt-3">
                 <div class="col-xl-6 mb-3">
                    <label class="col-form-label">Calle</label>
                    <input type="text" name="street" class="form-control" t-att-value="street or partner.street"/>
                 </div>
                 <div class="col-xl-6 mb-3">
                    <label class="col-form-label">Ciudad</label>
                    <input type="text" name="city" class="form-control" t-att-value="city or partner.city"/>
                 </div>
                 <div class="col-xl-6 mb-3">
                    <label class="col-form-label">País</label>
                    <select name="country_id" class="form-select">
                        <option value="">Seleccionar...</option>
                        <t t-foreach="countries or []" t-as="country">
                            <option t-att-value="country.id" t-att-selected="country.id == partner.country_id.id">
                                <t t-esc="country.name"/>
                            </option>
                        </t>
                    </select>
                 </div>
            </div>

        </template>


        <record id="view_portal_mx_bypass" model="ir.ui.view">
            <field name="name">portal.mx.bypass</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="portal.portal_my_details"/>
            <field name="priority">999</field>
            <field name="arch" type="xml">
                
                <xpath expr="//t[@t-call='portal.portal_my_details_fields']" position="replace">
                    <t t-call="mi_cuenta.mi_cuenta_fields_new"/>
                </xpath>

            </field>
        </record>

    </data>
</odoo>