<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- 1. QUITAR PRESELECCI√ìN AUTOM√ÅTICA -->
    <template id="quitar_preseleccion_delivery" inherit_id="website_sale_delivery.delivery_carrier_select">
        <!-- Remover el atributo checked de todos los radio buttons -->
        <xpath expr="//input[@name='o_delivery_radio'][@checked='checked']" position="attributes">
            <attribute name="checked"/>
        </xpath>
    </template>

    <!-- 2. SELECTOR DE SUCURSALES -->
    <template id="mi_checkout_con_sucursales" inherit_id="website_sale.checkout">
        
        <!-- CSS personalizado -->
        <xpath expr="//head" position="inside">
            <style>
                /* Forzar que ning√∫n radio est√© checked al cargar */
                input[name="o_delivery_radio"] {
                pointer-events: auto !important;
                }
                input[name="o_delivery_radio"]:checked {
                background-color: #0d6efd;
                border-color: #0d6efd;
                }
                /* Estilos para el selector de sucursales */
                #sucursal_select {
                    border: 2px solid #dee2e6;
                    transition: all 0.3s ease;
                }
                #sucursal_select:focus {
                    border-color: #0d6efd;
                    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
                }
                #sucursal_select.is-invalid {
                    border-color: #dc3545 !important;
                    background-image: none !important;
                }
                #sucursal_select.is-valid {
                    border-color: #198754 !important;
                    background-image: none !important;
                }
                #sucursal_error_msg {
                    display: none;
                    color: #dc3545;
                    font-size: 0.875rem;
                    margin-top: 0.5rem;
                }
                #sucursal_error_msg.show {
                    display: block !important;
                }
            </style>
        </xpath>
        
        <xpath expr="//t[@t-call='website_sale.billing_address_row']" position="before">
            
            <div class="mb-4 d-none" id="sucursal_picker_wrapper">
                <h4 class="fs-6 small text-uppercase fw-bolder text-primary">
                    <i class="fa fa-map-marker me-2"></i>
                    SELECCIONE LA SUCURSAL DONDE RECOGER√Å SU PEDIDO
                </h4>
                
                <div class="alert alert-info small mb-3" role="alert">
                    <i class="fa fa-info-circle me-1"></i>
                    Por favor, seleccione la sucursal de su preferencia para recoger su pedido.
                </div>
                
                <select name="sucursal_recogida_frontend" 
                        class="form-select form-select-lg" 
                        id="sucursal_select">
                    <option value="">-- Seleccione una sucursal --</option>
                    <option value="escuadron_201">üìç Escuadr√≥n 201 #300, Antiguo Aereopuerto</option>
                    <option value="lazaro_cardenas">üìç Av L√°zaro C√°rdenas 503-3, Col. Guelatao, Santa Luc√≠a</option>
                    <option value="cosijoeza">üìç Calle Cosijoeza #216-A, Barrio de Jalatlaco</option>
                    <option value="eucaliptos">üìç Eucaliptos #215 –í, Col. Reforma, 68050</option>
                    <option value="riveras">üìç Libramiento Riveras del Atoyac #122-2</option>
                    <option value="diaz_ordaz">üìç D√≠az Ordaz #710, Col. Centro</option>
                    <option value="eduardo_mata">üìç Av. Eduardo Mata #2302, Perif√©rico</option>
                    <option value="cristobal_colon">üìç Carretera Crist√≥bal Col√≥n #202, Santa Rosa</option>
                    <option value="yagul">üìç Calle Yagul esq. Cosijopi #122-A</option>
                    <option value="vicente_guerrero">üìç Vicente Guerrero, Centro, Oaxaca</option>
                </select>
                
                <div id="sucursal_error_msg">
                    <i class="fa fa-exclamation-triangle me-1"></i>
                    Por favor, seleccione una sucursal para continuar.
                </div>
            </div>
        </xpath>
    </template>
</odoo>